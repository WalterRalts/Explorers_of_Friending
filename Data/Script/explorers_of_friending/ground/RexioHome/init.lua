--[[
    init.lua
    Created: 03/08/2025 23:56:33
    Description: Autogenerated script file for the map RexioHome.
]]--
-- Commonly included lua functions and data
require 'origin.common'
require 'explorers_of_friending.ground.RexioHome.cutscene'

-- Package name
local RexioHome = {}

-------------------------------
-- Map Callbacks
-------------------------------
---RexioHome.Init(map)
--Engine callback function
function RexioHome.Init(map)

  if SV.entoh_town.HelperChapter == -1 then
    Aurm.Feeling()
  elseif SV.entoh_town.package_received == true and SV.entoh_town.HelperChapter == 2 then
    Aurm.Home()
  elseif KeyGet and SV.entoh_town.HelperChapter == 3 then
    Aurm.OpenIt()
  elseif SV.entoh_town.HelperChapter == 9 then
    Aurm2.LukeWarm()
  end

  if SV.entoh_town.AdventureChapter > 0 then
    GROUND:Hide("Luke")
  end

  if SV.entoh_town.HelperChapter == 3 then
    GROUND:Unhide("Package")
  end
  
end

---RexioHome.Enter(map)
--Engine callback function
function RexioHome.Enter(map)

  if SV.entoh_town.HelperChapter == -1 then
    
  else
    GAME:FadeIn(20)
  end
  

end

---RexioHome.Exit(map)
--Engine callback function
function RexioHome.Exit(map)


end

---RexioHome.Update(map)
--Engine callback function
function RexioHome.Update(map)

  if GAME:GetPlayerEquippedItem(0).ID == "held_power_band" and SV.entoh_town.HelperChapter == 4 then
    Aurm.Fashion()
    SV.entoh_town.HelperChapter = 5
  end

end

---RexioHome.GameSave(map)
--Engine callback function
function RexioHome.GameSave(map)


end

---RexioHome.GameLoad(map)
--Engine callback function
function RexioHome.GameLoad(map)

  GAME:FadeIn(20)

end

-------------------------------
-- Entities Callbacks
-------------------------------
function RexioHome.ApartmentEnter_Touch(obj, activator)
  if SV.entoh_town.HelperChapter == 4 then
    local rexio = CH("PLAYER")
    local luke = CH("Luke")

    UI:SetSpeaker(luke)
    UI:SetSpeakerEmotion("Worried")
    UI:WaitShowDialogue("Rexio.[pause=30] Where are you going?")
    UI:SetSpeakerEmotion("Normal")
    UI:WaitShowDialogue("At least let me see how you look in the band.")
  else
    GAME:FadeOut(false, 20)
    GAME:EnterGroundMap("ApartmentRooms", "RexioExit")
  end
end

function RexioHome.Poster_Action(obj, activator)
  local rexio = CH("PLAYER")

  UI:SetSpeaker(rexio)
  UI:SetSpeakerEmotion("Normal")
  UI:WaitShowDialogue("(This poster of dad is 10 times cooler with me on it.)")
  UI:SetSpeakerEmotion("Worried")
  UI:WaitShowDialogue("(We have to get another one, our walls are lacking.)")
end

function RexioHome.Luke_Action(obj, activator)
  local rexio = CH("PLAYER")
  local luke = CH("Luke")
  COMMON.FaceEachother("Luke", "PLAYER")
  if SV.entoh_town.HelperChapter < 3 then
    UI:SetSpeaker(luke)
    UI:SetSpeakerEmotion("Normal")
    UI:WaitShowDialogue("Go on, Rexio. [pause=30]Don't [emote=Happy]let me stop you.")

    UI:SetSpeaker(rexio)
    UI:SetSpeakerEmotion("Normal")
    UI:WaitShowDialogue("Feel free to, actually.")

    UI:SetSpeaker(luke)
    UI:SetSpeakerEmotion("Determined")
    UI:WaitShowDialogue("Rexio.")

    UI:SetSpeaker(rexio)
    UI:SetSpeakerEmotion("Happy")
    UI:WaitShowDialogue("Kidding, kidding.")
  elseif SV.entoh_town.HelperChapter == 3 then
    UI:SetSpeaker(luke)
    UI:SetSpeakerEmotion("Worried")
    UI:WaitShowDialogue("If you're asking for a hint, then I can't really help.")
    UI:SetSpeakerEmotion("Stunned")
    UI:WaitShowDialogue("I, uh, forgot where I put the key.")

    UI:SetSpeaker(rexio)
    UI:SetSpeakerEmotion("Stunned")
    UI:WaitShowDialogue("Wow.")
  else
    UI:SetSpeaker(luke)
    UI:SetSpeakerEmotion("Worried")
    UI:WaitShowDialogue("You just have to put the band on.")
  end
end

function RexioHome.FlowerPot_Action(obj, activator)
  local rexio = CH("PLAYER")

  UI:SetSpeaker(rexio)
  UI:SetSpeakerEmotion("Worried")
  UI:WaitShowDialogue("(Mom picked these flowers before she left. Said they were made for me.)")
  UI:SetSpeakerEmotion("Normal")
  UI:WaitShowDialogue("(These are just flowers I can get from outside, though.)")

  --GROUND:CharSetAnim(rexio, "None", true)
  GAME:WaitFrames(95)
  COMMON.CharSweatdrop("PLAYER")
  UI:SetSpeakerEmotion("Sad")
  GROUND:CharSetAnim(rexio, "", true)
  UI:WaitShowDialogue("(I hope she's doing okay...)")
end

return RexioHome

