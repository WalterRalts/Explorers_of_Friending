--[[
    init.lua
    Created: 08/11/2024 14:35:15
    Description: Autogenerated script file for the map TarroTownHive.
]]--
-- Commonly included lua functions and data
require 'origin.common'
require 'explorers_of_friending.partner'

-- Package name
local TarroTownHive = {}

-------------------------------
-- Map Callbacks
-------------------------------
---TarroTownHive.Init(map)
--Engine callback function
function TarroTownHive.Init(map)
  MapStrings = STRINGS.MapStrings
  COMMON.RespawnAllies()
  local partner = CH('Teammate1')
  AI:SetCharacterAI(partner, "origin.ai.ground_partner", CH('PLAYER'), partner.Position)
  partner.CollisionDisabled = true
  
end

---TarroTownHive.Enter(map)
--Engine callback function
function TarroTownHive.Enter(map)
  SleepingPuchi = false
  GAME:FadeIn(20)
end

---TarroTownHive.Exit(map)
--Engine callback function
function TarroTownHive.Exit(map)


end

---TarroTownHive.Update(map)
--Engine callback function
function TarroTownHive.Update(map)
  Partner()
end

---TarroTownHive.GameSave(map)
--Engine callback function
function TarroTownHive.GameSave(map)

end

---TarroTownHive.GameLoad(map)
--Engine callback function
function TarroTownHive.GameLoad(map)

  GAME:FadeIn(20)

end

-------------------------------
-- Entities Callbacks
-------------------------------

function TarroTownHive.HoneyShop_Action(obj, activator)
  local cute = CH("Cute")
  local azura = CH('Teammate1')

  pouch_money = GAME:GetPlayerMoney()
  UI:SetSpeaker(cute)
  UI:SetSpeakerEmotion("Happy")
  UI:WaitShowDialogue("Oh my goodness, hi hi hi!")
  local choices = {("Yes!"),
        ("No!")}
    UI:BeginChoiceMenu("What some honey?! Only 100 Poke!", choices, 1, 2)
    UI:WaitForChoice()
    result = UI:ChoiceResult()
    if result == 1 then
      if pouch_money < 100 then
        COMMON.CharSweatdrop("Cute")
        UI:SetSpeakerEmotion("Worried")
        UI:WaitShowDialogue("Sorry, I can't just give these on a discount.")
        UI:SetSpeakerEmotion("Normal")
        UI:WaitShowDialogue("Ms. Mayor refuses to let me give out our plentiful supply out of an event.")
      else
        SOUND:PlaySE("Battle/DUN_Money")
        GAME:RemoveFromPlayerMoney(100)
        GROUND:MoveToPosition(cute, 309, 181, false, 10)
        GAME:WaitFrames(70)
        SOUND:PlaySE("EVT_CH02_Item_Place")
        GROUND:MoveToPosition(cute, 323, 181, false, 10)
        GROUND:CharAnimateTurn(cute, Direction.DownRight, 2, true)
        GROUND:Unhide("PurchasedHoney")
        GAME:WaitFrames(20)
        GROUND:MoveToPosition(cute, 315, 175, false, 10)
        GROUND:CharAnimateTurn(cute, Direction.Down, 2, true)
        UI:SetSpeakerEmotion("Happy")
        GAME:GivePlayerItem("packed_honey")
        UI:WaitShowDialogue("There you go! Enjoy!")
        
        GROUND:Hide("PurchasedHoney")
        UI:SetSpeaker(azura)
        UI:SetSpeakerEmotion("Joyous")
        UI:WaitShowDialogue("Yeah! Honey!")
      end
    else
      UI:SetSpeaker(cute)
      UI:SetSpeakerEmotion("Normal")
      UI:WaitShowDialogue("Oh? Not today? Oh well,[pause=35] s[emote=Happy]afe travels, then!")
    end
end

function TarroTownHive.Sir_Lick_Action(obj, activator)
  local lick = CH("Sir_Lick")
  local gulp = CH("Sir_Gulp")
  local peck = CH("Sir_Peck")

  UI:SetSpeaker(peck)
  UI:SetSpeakerEmotion("Angry")
  UI:WaitShowDialogue("Hungry!!")

  UI:SetSpeaker(gulp)
  UI:SetSpeakerEmotion("Worried")
  UI:WaitShowDialogue("[speed=0.75]Oh bother. This was a bad idea.")

  UI:SetSpeaker(peck)
  UI:SetSpeakerEmotion("Angry")
  UI:WaitShowDialogue("Where's the food?!")
  UI:SetSpeakerEmotion("Determined")
  UI:WaitShowDialogue("[speed=0.6]My hunger must be s[emote=Angry]atiated!!")

  UI:SetSpeaker(lick)
  UI:SetSpeakerEmotion("Worried")
  UI:WaitShowDialogue("But I'm the one, [emote=Normal]pbllt![pause=45] [emote=Angry]I'm the one paying for this, pbllt!")

  UI:SetSpeaker(peck)
  UI:SetSpeakerEmotion("Angry")
  UI:WaitShowDialogue("I do not caaaaare! Fooooooooood!!")
end

function TarroTownHive.Sir_Gulp_Action(obj, activator)
  TarroTownHive.Sir_Lick_Action()
end

function TarroTownHive.Sir_Peck_Action(obj, activator)
  TarroTownHive.Sir_Lick_Action()
end

function TarroTownHive.Geoff_Action(obj, activator)
  UI:SetSpeaker(CH("Geoff"))
  UI:SetSpeakerEmotion("Normal")
  UI:WaitShowDialogue("Food here... acceptable.[pause=20] I give it 9 of 10,[pause=25] much better food at island.")
end

function TarroTownHive.Ratio_Action(obj, activator)
  UI:SetSpeaker(CH("Ratio"))
  UI:SetSpeakerEmotion("Happy")
  UI:WaitShowDialogue("Chomped and devoured,[pause=25] waiting for my seconds!")
end

function TarroTownHive.Nyast_Action(obj, activator)
  UI:SetSpeaker(CH("Nyast"))
  UI:SetSpeakerEmotion("Worried")
  UI:WaitShowDialogue("I am not a fan of these priceees.[pause=40] If I were on the island, I'd probably, like, scratch their faceees...")
end

--Entrances
function TarroTownHive.MayorEntrance_Touch(obj, activator)
  local maru = CH('PLAYER')

  if SV.tarro_town.DarknessChapter > 0 then
    
  else
    UI:SetSpeaker(maru)
    UI:SetSpeakerEmotion("Worried")
    UI:WaitShowDialogue("(Probably better stuff to do then bothering the mayor for no reason...)")
  end
end

function TarroTownHive.TTSquare_HiveExit_Touch(obj, activator)
  GAME:FadeOut(false, 20)
  outside_enter = 3
  if SV.tarro_town.PieChapter >= 10 then
    GAME:EnterGroundMap("TarroTownSquare_ch3", "TTSquare_WestEnter")
  else
    GAME:EnterGroundMap("TarroTownSquare", "TTSquare_WestEnter")
  end
end

return TarroTownHive



